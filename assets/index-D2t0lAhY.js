import{X as T,af as P,Z as u,_ as a,F as t,V as B,ar as I,ah as c,aj as s,as as D,at as F,au as G,ad as M,v as d,c as y,Y as k,av as O,I as x,a0 as C,aw as U,ai as j,G as w}from"./index-D5AbFdb1.js";import{p as N}from"./product-DBt-vjjm.js";import{V as R,a as _,b as S}from"./route-block-DhdQpsR2.js";import{V as X,a as b,b as Y,c as Z}from"./VPagination-CzPggjWa.js";import{V as q,a as z}from"./VList-D52y1nIb.js";import{V as H}from"./VContainer-BkXp5onC.js";import"./ssrBoot-B8DZFry5.js";import"./VDivider-DMlEPX4j.js";const J={__name:"productCard",props:["_id","image","name","category","price","description"],setup(o){return(m,i)=>{const p=T("router-link");return u(),P(G,null,{default:a(()=>[t(B,{class:"cursor-pointer",cover:"",height:"300",src:o.image,onClick:i[0]||(i[0]=n=>m.$router.push("/product/"+m.item.product._id))},null,8,["src"]),t(I,null,{default:a(()=>[t(p,{class:"text-decoration-none text-white",to:"/product/"+o._id},{default:a(()=>[c(s(o.name),1)]),_:1},8,["to"])]),_:1}),t(D,null,{default:a(()=>[c(s(o.category)+" / "+s(o.price),1)]),_:1}),t(F,null,{default:a(()=>[c(s(o.description),1)]),_:1})]),_:1})}}},h=3,K={__name:"index",setup(o){const m=M(),i=d([]),p=y(()=>i.value.filter(l=>{const r=l.name.toLowerCase().includes(v.value.toLowerCase()),e=f.value?l.category===f.value:!0;return r&&e}).sort((l,r)=>{const e=g[V.value];return e.key==="createdAt"||e.key==="updatedAt"?e.direction*(new Date(l[e.key])-new Date(r[e.key])):e.direction*(l[e.key]>r[e.key]?1:-1)})),n=d(1),$=y(()=>Math.ceil(p.value.length/h)),A=y(()=>p.value.slice((n.value-1)*h,n.value*h)),v=d(""),f=d(""),E=["電子產品","服裝","家居用品","書籍","玩具","食品","其他"],V=d(0),g=[{text:"價格：低到高",key:"price",direction:1},{text:"價格：高到低",key:"price",direction:-1},{text:"最新商品",key:"createdAt",direction:-1},{text:"最舊商品",key:"createdAt",direction:1},{text:"名稱",key:"name",diretion:1}];return(async()=>{try{const{data:l}=await N.get();i.value=l.products}catch(l){console.error("Error fetching products:",l),m({text:"無法載入商品資料",snackbarProps:{color:"red"}})}})(),(l,r)=>(u(),P(H,null,{default:a(()=>[t(R,{justify:"center"},{default:a(()=>[t(_,{cols:"12"},{default:a(()=>[t(O,{modelValue:v.value,"onUpdate:modelValue":[r[0]||(r[0]=e=>v.value=e),r[1]||(r[1]=e=>n.value=1)],flat:"","hide-details":"",placeholder:"搜尋商品","prepend-inner-icon":"mdi-magnify",variant:"solo"},null,8,["modelValue"]),t(X,{modelValue:f.value,"onUpdate:modelValue":[r[2]||(r[2]=e=>f.value=e),r[3]||(r[3]=e=>n.value=1)],mandatory:""},{default:a(()=>[t(b,{filter:"",text:"全部",value:"",variant:"outlined"}),(u(),k(x,null,C(E,e=>t(b,{key:e,filter:"",text:e,value:e,variant:"outlined"},null,8,["text","value"])),64)),t(U),t(Y,null,{activator:a(({props:e})=>[t(j,w(e,{"append-icon":"mdi-chevron-down",ripple:!1,variant:"text"}),{default:a(()=>[c(s(g[V.value].text),1)]),_:2},1040)]),default:a(()=>[t(q,null,{default:a(()=>[(u(),k(x,null,C(g,(e,L)=>t(z,{key:e.text,page:"1",onClick:W=>V.value=L},{default:a(()=>[c(s(e.text),1)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),(u(!0),k(x,null,C(A.value,e=>(u(),P(_,{key:e._id,cols:"12",lg:"4",md:"6"},{default:a(()=>[t(J,w({ref_for:!0},e),null,16)]),_:2},1024))),128)),t(_,{cols:"12"},{default:a(()=>[t(Z,{modelValue:n.value,"onUpdate:modelValue":r[4]||(r[4]=e=>n.value=e),circle:"",length:$.value,"total-visible":5},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}))}};typeof S=="function"&&S(K);export{K as default};
